<div class="container py-5 mt-5" dir="rtl">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold mb-0">转专转 </h2>
        <button class="btn btn-outline-primary btn-sm rounded-pill" (click)="markAllRead()">
            <i class="bi bi-check-all ms-1"></i> 住  拽专
        </button>
    </div>

    @if (loading()) {
    <div class="d-flex justify-content-center py-5">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">注...</span>
        </div>
    </div>
    } @else if (notifications().length === 0) {
    <div class="text-center py-5 text-muted">
        <i class="bi bi-bell-slash fs-1 d-block mb-3 opacity-50"></i>
        <p class="fs-5">  转专转 砖转</p>
    </div>
    } @else {
    <div class="d-flex flex-column gap-3">
        @for (n of notifications(); track n.id) {
        <div class="card border-0 shadow-sm notification-card" [class.unread]="!n.isRead" [class.read]="n.isRead"
            (click)="markAsRead(n)">
            <div class="card-body d-flex align-items-center p-3">

                <!-- Icon based on Type -->
                <div class="icon-box ms-3 shrink-0" [class.bg-success-subtle]="n.type === 'Success'"
                    [class.text-success]="n.type === 'Success'" [class.bg-info-subtle]="n.type === 'Info'"
                    [class.text-info]="n.type === 'Info'" [class.bg-warning-subtle]="n.type === 'Warning'"
                    [class.text-warning]="n.type === 'Warning'">
                    @if (n.type === 'Success') { <i class="bi bi-check-lg fs-5"></i> }
                    @else if (n.type === 'Warning') { <i class="bi bi-exclamation-lg fs-5"></i> }
                    @else { <i class="bi bi-info-lg fs-5"></i> }
                </div>

                <div class="flex-grow-1">
                    <div class="d-flex justify-content-between align-items-start mb-1">
                        <h6 class="mb-0 fw-bold text-dark">{{ n.title }}</h6>
                        <small class="text-muted" style="font-size: 0.75rem;">{{ n.createdAt | date:'dd/MM/yy HH:mm'
                            }}</small>
                    </div>
                    <p class="mb-0 text-secondary small text-truncate-2">{{ n.body }}</p>
                </div>

                @if (!n.isRead) {
                <div class="ms-2"><span class="badge bg-primary rounded-circle p-1"> </span></div>
                }

            </div>
        </div>
        }
    </div>
    }

    <!-- Mission Details Modal -->
    @if (selectedMission()) {
    <app-mission-details-modal [mission]="selectedMission()" (close)="closeMissionDetails()">
    </app-mission-details-modal>
    }
</div>